# Remove columns with mostly missing values (threshold of 60% missing)
threshold = 0.6 * len(train_data)
train_data.dropna(axis=1, thresh=threshold, inplace=True)

# Drop irrelevant columns for modeling (like timestamps or IDs)
columns_to_drop = ['X', 'user_name', 'raw_timestamp_part_1', 'raw_timestamp_part_2', 'cvtd_timestamp', 'new_window', 'num_window']
train_data.drop(columns=columns_to_drop, inplace=True)

# Convert class variable to categorical type
train_data['classe'] = train_data['classe'].astype('category')

# Replace categorical values with numerical labels
class_labels = train_data['classe'].cat.codes
train_data['classe'] = class_labels
